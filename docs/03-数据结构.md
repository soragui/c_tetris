# ç¬¬ 3 è¯¾ï¼šæ•°æ®ç»“æ„ ğŸ—ï¸

## 3.1 æ–¹å—ï¼ˆTetrominoï¼‰

ä¿„ç½—æ–¯æ–¹å—æœ‰ 7 ç§æ ‡å‡†æ–¹å—ï¼š

```
I: â–ˆâ–ˆâ–ˆâ–ˆ    O: â–ˆâ–ˆ    T: â–ˆâ–ˆâ–ˆ    S:  â–ˆâ–ˆ
             â–ˆâ–ˆ         â–ˆ          â–ˆâ–ˆ
                                   
J: â–ˆâ–ˆâ–ˆ     Z: â–ˆâ–ˆ      L: â–ˆâ–ˆâ–ˆ
   â–ˆ          â–ˆâ–ˆ         â–ˆ
```

### ä»£ç å®ç°

```c
// tetromino.h
#define BOARD_WIDTH   10
#define BOARD_HEIGHT  20

typedef enum {
    TETRO_I, TETRO_O, TETRO_T, TETRO_S,
    TETRO_Z, TETRO_J, TETRO_L, TETRO_COUNT
} TetrominoType;

typedef struct {
    TetrominoType type;     // æ–¹å—ç±»å‹
    int x, y;               // ä½ç½®
    int rotation;           // æ—‹è½¬çŠ¶æ€ (0-3)
    int color;              // é¢œè‰²
    int shape[4][4];        // 4x4 å½¢çŠ¶çŸ©é˜µ
} Tetromino;
```

**ä¸ºä»€ä¹ˆç”¨ 4x4 çŸ©é˜µï¼Ÿ**
- æ‰€æœ‰æ–¹å—éƒ½èƒ½æ”¾å…¥ 4x4 ç½‘æ ¼
- æ—‹è½¬æ“ä½œç®€å•ï¼ˆçŸ©é˜µæ—‹è½¬ï¼‰
- ç¢°æ’æ£€æµ‹æ–¹ä¾¿

## 3.2 æ¸¸æˆæ¿ï¼ˆBoardï¼‰

```c
// board.h
typedef struct {
    int cells[BOARD_HEIGHT][BOARD_WIDTH];  // æ¸¸æˆç½‘æ ¼
    int filled_rows[BOARD_HEIGHT];         // æ¯è¡Œå¡«å……æ•°
} Board;
```

**cells æ•°ç»„ï¼š**
- `0` = ç©ºæ ¼
- `1-7` = ä¸åŒé¢œè‰²çš„æ–¹å—

```
cells[20][10] ç¤ºä¾‹ï¼š
0 0 0 0 0 0 0 0 0 0  â† ç¬¬ 0 è¡Œï¼ˆé¡¶éƒ¨ï¼‰
0 0 0 0 0 0 0 0 0 0
...
0 0 5 5 0 0 3 3 3 0  â† ç¬¬ 18 è¡Œ
0 0 5 5 0 0 0 3 0 0  â† ç¬¬ 19 è¡Œï¼ˆåº•éƒ¨ï¼‰
```

## 3.3 æ¸¸æˆçŠ¶æ€ï¼ˆGameï¼‰

```c
// game.h
typedef struct {
    Board board;            // æ¸¸æˆæ¿
    Tetromino current;      // å½“å‰æ–¹å—
    Tetromino next;         // ä¸‹ä¸€ä¸ªæ–¹å—
    Tetromino hold;         // ä¿ç•™çš„æ–¹å—
    bool has_held;          // æœ¬å›åˆæ˜¯å¦å·²ä½¿ç”¨ä¿ç•™
    int score;              // åˆ†æ•°
    int level;              // ç­‰çº§
    int lines_cleared;      // æ¶ˆé™¤è¡Œæ•°
    int drop_interval;      // ä¸‹è½é—´éš” (ms)
    bool running;           // æ¸¸æˆæ˜¯å¦è¿è¡Œ
    bool paused;            // æ˜¯å¦æš‚åœ
    bool game_over;         // æ¸¸æˆæ˜¯å¦ç»“æŸ
} Game;
```

## 3.4 æ•°æ®ç»“æ„å…³ç³»å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Game                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Board    â”‚  â”‚  Tetromino      â”‚ â”‚
â”‚  â”‚  cells[]  â”‚  â”‚  current        â”‚ â”‚
â”‚  â”‚  [20][10] â”‚  â”‚  next           â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  hold           â”‚ â”‚
â”‚                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  score, level, running...           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## âœ… æœ¬è¯¾æ£€æŸ¥æ¸…å•

- [ ] ç†è§£ 7 ç§æ–¹å—ç±»å‹
- [ ] çŸ¥é“ä¸ºä»€ä¹ˆç”¨ 4x4 çŸ©é˜µ
- [ ] ç†è§£æ¸¸æˆæ¿çš„æ•°ç»„ç»“æ„
- [ ] æŒæ¡ Game ç»“æ„ä½“çš„ç»„æˆ

---

ä¸‹ä¸€è¯¾ï¼š[æ¸¸æˆå¾ªç¯](05-æ¸¸æˆå¾ªç¯.md)
