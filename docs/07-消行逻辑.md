# 第 7 课：消行逻辑 🧹

## 7.1 检测满行

从底部向上检查每一行是否全满。

## 7.2 消除并下落

```c
for (int y = BOARD_HEIGHT - 1; y >= 0; y--) {
    bool full = true;
    
    // 检查是否全满
    for (int x = 0; x < BOARD_WIDTH; x++) {
        if (!board->cells[y][x]) {
            full = false;
            break;
        }
    }
    
    if (full) {
        // 下移上面的行
        for (int yy = y; yy > 0; yy--) {
            memcpy(board->cells[yy], board->cells[yy-1], 
                   sizeof(board->cells[0]));
        }
        memset(board->cells[0], 0, sizeof(board->cells[0]));
        y++;  // 重新检查
    }
}
```

## 7.3 计分规则

| 行数 | 基础分 |
|------|--------|
| 1 行 | 40     |
| 2 行 | 100    |
| 3 行 | 300    |
| 4 行 | 1200   |

实际分数 = 基础分 × (等级 + 1)

## ✅ 本课检查清单

- [ ] 理解消行原理
- [ ] 会检测满行
- [ ] 掌握行下落实现
- [ ] 知道计分规则

---

下一课：[UI 界面](08-UI 界面.md)
