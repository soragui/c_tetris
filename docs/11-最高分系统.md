# ç¬¬ 11 è¯¾ï¼šæœ€é«˜åˆ†ç³»ç»Ÿ ğŸ†

## 11.1 ç³»ç»ŸåŠŸèƒ½

- ä¿å­˜å‰ 10 åæœ€é«˜åˆ†
- æ¸¸æˆç»“æŸæ—¶è¾“å…¥åå­—
- æ˜¾ç¤ºæ’è¡Œæ¦œ

## 11.2 æ•°æ®ç»“æ„

```c
#define MAX_SCORES 10

typedef struct {
    char name[32];   // ç©å®¶åå­—
    int score;       // åˆ†æ•°
    int lines;       // æ¶ˆé™¤è¡Œæ•°
    int level;       // ç­‰çº§
    time_t date;     // æ—¶é—´æˆ³
} HighScore;

HighScore high_scores[MAX_SCORES];
```

## 11.3 ä¿å­˜æœ€é«˜åˆ†

```c
void save_high_score(const char* name, int score, 
                     int lines, int level) {
    HighScore new_score = {
        .score = score,
        .lines = lines,
        .level = level,
        .date = time(NULL)
    };
    strncpy(new_score.name, name, 31);
    
    // æ’å…¥æ’åºï¼ˆæŒ‰åˆ†æ•°é™åºï¼‰
    for (int i = 0; i < MAX_SCORES; i++) {
        if (score > high_scores[i].score) {
            // åç§»
            for (int j = MAX_SCORES - 1; j > i; j--) {
                high_scores[j] = high_scores[j-1];
            }
            high_scores[i] = new_score;
            break;
        }
    }
    
    // ä¿å­˜åˆ°æ–‡ä»¶
    FILE* f = fopen("data/highscores.txt", "w");
    for (int i = 0; i < MAX_SCORES; i++) {
        if (high_scores[i].score > 0) {
            fprintf(f, "%s %d %d %d %ld\n",
                    high_scores[i].name,
                    high_scores[i].score,
                    high_scores[i].lines,
                    high_scores[i].level,
                    high_scores[i].date);
        }
    }
    fclose(f);
}
```

## 11.4 åŠ è½½æœ€é«˜åˆ†

```c
void load_high_scores(void) {
    FILE* f = fopen("data/highscores.txt", "r");
    if (!f) return;  // æ–‡ä»¶ä¸å­˜åœ¨
    
    for (int i = 0; i < MAX_SCORES; i++) {
        if (fscanf(f, "%31s %d %d %d %ld",
                   high_scores[i].name,
                   &high_scores[i].score,
                   &high_scores[i].lines,
                   &high_scores[i].level,
                   &high_scores[i].date) != 5) {
            break;
        }
    }
    fclose(f);
}
```

## 11.5 æ¸¸æˆç»“æŸè¾“å…¥åå­—

```c
if (is_new_high_score(game->score)) {
    clear();
    mvprintw(5, 10, "NEW HIGH SCORE!");
    mvprintw(7, 10, "Enter your name: ");
    refresh();
    
    echo();       // æ˜¾ç¤ºè¾“å…¥
    curs_set(1);  // æ˜¾ç¤ºå…‰æ ‡
    
    char name[32];
    // ... è·å–ç”¨æˆ·è¾“å…¥
    
    save_high_score(name, game->score, 
                    game->lines_cleared, game->level);
    
    noecho();
    curs_set(0);
}
```

## 11.6 æ˜¾ç¤ºæ’è¡Œæ¦œ

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘         TETRIS HIGH SCORES           â•‘
â• â•â•â•â•â•â•â•¤â•â•â•â•â•â•â•â•â•â•â•â•¤â•â•â•â•â•â•â•â•¤â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘ Rank â”‚   Name    â”‚ Score â”‚   Level   â•‘
â• â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•£
â•‘   1  â”‚ Alice     â”‚  5000 â”‚     8     â•‘
â•‘   2  â”‚ Bob       â”‚  3200 â”‚     6     â•‘
â•‘   3  â”‚ Player    â”‚  1250 â”‚     5     â•‘
â•šâ•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•
```

## âœ… æœ¬è¯¾æ£€æŸ¥æ¸…å•

- [ ] ç†è§£æœ€é«˜åˆ†æ•°æ®ç»“æ„
- [ ] æŒæ¡æ’å…¥æ’åºç®—æ³•
- [ ] ä¼šä¿å­˜å’ŒåŠ è½½æ–‡ä»¶
- [ ] çŸ¥é“å¦‚ä½•å¤„ç†ç”¨æˆ·è¾“å…¥

---

[è¿”å›ç›®å½•](00-ç›®å½•.md)
